{"version":3,"sources":["../../app/middleware/error-handler.js"],"names":["errorHandler","err","req","res","next","sendStatus","error","message","envs","development","stack","errors","type","status","json"],"mappings":";;;;;kBAIwBA,Y;;AAFxB;;;;;;AAEe,SAASA,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,IAArC,EAA2C;AACxD,MAAI,CAACH,GAAL,EAAU;AACR,WAAOE,IAAIE,UAAJ,CAAe,GAAf,CAAP;AACD;;AAED,MAAMC,QAAQ;AACZC,aAASN,IAAIM,OAAJ,IAAe;AADZ,GAAd;;AAIA,MAAI,oBAAUC,IAAV,CAAeC,WAAnB,EAAgC;AAC9BH,UAAMI,KAAN,GAAcT,IAAIS,KAAlB;AACD;;AAED,MAAIT,IAAIU,MAAR,EAAgB;AACdL,UAAMK,MAAN,GAAe,EAAf;AADc,QAENA,MAFM,GAEKV,GAFL,CAENU,MAFM;;AAGd,SAAK,IAAMC,IAAX,IAAmBD,MAAnB,EAA2B;AACzB,UAAIC,QAAQD,MAAZ,EAAoB;AAClBL,cAAMK,MAAN,CAAaC,IAAb,IAAqBD,OAAOC,IAAP,EAAaL,OAAlC;AACD;AACF;AACF;;AAEDJ,MAAIU,MAAJ,CAAWZ,IAAIY,MAAJ,IAAc,GAAzB,EAA8BC,IAA9B,CAAmCR,KAAnC;AACD","file":"error-handler.js","sourcesContent":["/* @flow */\n\nimport Constants from '../config/constants'\n\nexport default function errorHandler(err, req, res, next) {\n  if (!err) {\n    return res.sendStatus(500)\n  }\n\n  const error = {\n    message: err.message || 'Internal Server Error.',\n  }\n\n  if (Constants.envs.development) {\n    error.stack = err.stack\n  }\n\n  if (err.errors) {\n    error.errors = {}\n    const { errors } = err\n    for (const type in errors) {\n      if (type in errors) {\n        error.errors[type] = errors[type].message\n      }\n    }\n  }\n\n  res.status(err.status || 500).json(error)\n}\n"]}